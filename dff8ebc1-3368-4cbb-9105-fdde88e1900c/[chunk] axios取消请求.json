%7B%22t%22:1646720971239,%22tag%22:%5B%22axios%22,%22%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82%22,%22vue-pinia%22%5D,%22note%22:%22vue3%E4%B8%AD%E4%BD%BF%E7%94%A8pinia%E5%AF%B9axios%E5%90%84%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%B0%81%E8%A3%85,%20%E5%9C%A8%E5%BD%93%E5%89%8D%E7%BB%84%E4%BB%B6%E8%B0%83%E7%94%A8useAxiosStore().get(...)%20/%20useAxiosStore().post(...)%20%E7%AD%89%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C%E8%AF%B7%E6%B1%82%EF%BC%8C%E4%BD%BF%E7%94%A8useAxiosStore().cancelAll()%E5%8F%96%E6%B6%88%E6%8C%87%E5%AE%9Ascope%E4%B8%8B%E7%9A%84%E5%85%A8%E9%83%A8%E8%AF%B7%E6%B1%82%E3%80%82%22,%22data%22:%22%3Cp%3Eimport%20%7B%20defineStore%20%7D%20from%20%5C%22pinia%5C%22;%3C/p%3E%3Cp%3Eimport%20axios,%20%7B%20AxiosRequestConfig,%20CancelTokenSource%20%7D%20from%20%5C%22axios%5C%22;%3C/p%3E%3Cp%3E%3Cbr%3E%3C/p%3E%3Cp%3Einterface%20ScopeTokenPair%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;scope:%20string%3C/p%3E%3Cp%3E&nbsp;&nbsp;cancelToken:%20CancelTokenSource%3C/p%3E%3Cp%3E%7D%3C/p%3E%3Cp%3E%3Cbr%3E%3C/p%3E%3Cp%3Eexport%20const%20useAxiosStore%20=%20defineStore(%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;id:%20'axios-store',%3C/p%3E%3Cp%3E&nbsp;&nbsp;state:%20()%20=&gt;%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;return%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scopeTokenPairList:%20%5B%5D%20as%20ScopeTokenPair%5B%5D%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;%7D%3C/p%3E%3Cp%3E&nbsp;&nbsp;%7D,%3C/p%3E%3Cp%3E&nbsp;&nbsp;actions:%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;get(scope:%20string,%20url:%20string,%20config?:%20AxiosRequestConfig&lt;any&gt;)%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const%20pair%20=%20this.scopeTokenPairList.find((item)%20=&gt;%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return%20item.scope%20===%20scope%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!pair)%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const%20cancelToken%20=%20axios.CancelToken.source()%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.scopeTokenPairList.push(%7B%20scope,%20cancelToken%20%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return%20axios.get(url,%20%7B%20...config,%20cancelToken:%20cancelToken.token%20%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%7D%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return%20axios.get(url,%20%7B%20...config,%20cancelToken:%20pair.cancelToken.token%20%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%7D%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;%7D,%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;post(scope:%20string,%20url:%20string,%20data:%20any,%20config:%20AxiosRequestConfig&lt;any&gt;)%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const%20pair%20=%20this.scopeTokenPairList.find((item)%20=&gt;%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return%20item.scope%20===%20scope%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!pair)%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const%20cancelToken%20=%20axios.CancelToken.source()%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.scopeTokenPairList.push(%7B%20scope,%20cancelToken%20%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return%20axios.post(url,%20data,%20%7B%20...config,%20cancelToken:%20cancelToken.token%20%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%7D%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return%20axios.post(url,%20data,%20%7B%20...config,%20cancelToken:%20pair.cancelToken.token%20%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%7D%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;%7D,%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;cancelAll(scope:%20string)%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!scope)%20return%3C/p%3E%3Cp%3E%3Cbr%3E%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const%20pair%20=%20this.scopeTokenPairList.find((item)%20=&gt;%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return%20item.scope%20===%20scope%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%7D)%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!!pair)%20%7B%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pair.cancelToken.cancel()%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//%20todo:%20%E5%8F%96%E6%B6%88%E5%90%8E%E5%88%A0%E9%99%A4%E6%8E%89%E8%AF%A5%E7%BB%84%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%7D%3C/p%3E%3Cp%3E&nbsp;&nbsp;&nbsp;&nbsp;%7D%3C/p%3E%3Cp%3E&nbsp;&nbsp;%7D%3C/p%3E%3Cp%3E%7D)%3C/p%3E%22%7D